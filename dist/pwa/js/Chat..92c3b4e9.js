(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"485e":function(e,t,a){},a4ea:function(e,t,a){"use strict";a("ed49")},ab55:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-ma-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-card",{staticClass:"my-card login-box"},[a("q-card-section",[a("h3",{staticClass:".text-h3 login-title"},[e._v(" Choose Your chat\n                ")])]),a("q-card-section",e._l(e.chats,(function(t){return a("q-item",{key:t.ID,staticClass:"chat-item",attrs:{clickable:""},on:{click:function(a){return e.toChat(t.ID,t.name)}}},[a("q-item-section",[e._v(e._s(t.name))])],1)})),1),a("q-card-section",[a("h5",[e._v("Create another Chat")]),a("q-input",{staticClass:"input",attrs:{label:"Chat Name",bla:!0},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createNewChat(t)}},model:{value:e.newChat,callback:function(t){e.newChat=t},expression:"newChat"}}),a("q-btn",{staticClass:"btn-create-chat",attrs:{color:"primary",label:"Create other chat",loading:e.isLoading},on:{click:e.createNewChat}})],1)],1)],1)])},s=[],n={name:"Chat",data(){return{isLoading:!1,chats:[],newChat:""}},beforeCreate(){console.log("beforeCreate")},created(){console.log("created"),console.log(this.$moment().format("MMMM Do YYYY, h:mm:ss a"))},beforeMount(){console.log("beforeMount")},mounted(){console.log("mounted"),this.getAllChats()},beforeUpdate(){console.log("beforeUpdate")},updated(){console.log("updated")},beforeDestroy(){console.log("beforeDestroy")},destroyed(){console.log("destroyed")},methods:{getAllChats(){let e=localStorage.getItem("token");this.$axios.get("/v1/api/chat/rooms",{headers:{Authorization:`Bearer ${e}`}}).then((e=>{this.chats=e.data.chatRooms})).catch((e=>{console.log(e)}))},createNewChat(){if(""==this.newChat)return;let e=localStorage.getItem("token");this.$axios.post("/v1/api/chat/create",{name:this.newChat},{headers:{Authorization:`Bearer ${e}`}}).then((e=>{this.newChat="",this.getAllChats()})).catch((e=>{console.log(e)}))},toChat(e,t){this.$router.push({path:"/conversation/"+e,query:{name:t}})}}},c=n,r=(a("ac93"),a("2877")),i=a("f09f"),l=a("a370"),h=a("66e5"),d=a("4074"),u=a("27f9"),m=a("9c40"),g=a("eebe"),f=a.n(g),C=Object(r["a"])(c,o,s,!1,null,null,null);t["default"]=C.exports;f()(C,"components",{QCard:i["a"],QCardSection:l["a"],QItem:h["a"],QItemSection:d["a"],QInput:u["a"],QBtn:m["a"]})},ac93:function(e,t,a){"use strict";a("485e")},c089:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-ma-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-card",{staticClass:"my-card login-box"},[a("q-card-section",[a("h3",{staticClass:".text-h3 login-title"},[e._v(" "+e._s(e.chat_name)+"\n                ")])]),a("q-card-section",[a("div",{staticClass:"overflow"},e._l(e.messages,(function(t){return a("div",{key:t.id,staticStyle:{width:"100%","max-width":"700px",height:"auto"}},[t.chatUserId==e.user.ID?a("q-chat-message",{attrs:{name:"me",text:[t.chatMessage],sent:"","bg-color":"amber-7"}}):e._e(),t.chatUserId!=e.user.ID&&-1!=t.chatUserId?a("q-chat-message",{attrs:{name:t.chatUser,text:[t.chatMessage],size:"6","text-color":"white","bg-color":"secondary"}}):e._e(),-1==t.chatUserId?a("p",[e._v(e._s(t.chatMessage))]):e._e()],1)})),0)]),a("q-card-section",[a("q-input",{staticClass:"input",attrs:{label:"Chat Name",bla:!0},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send(t)}},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}}),a("q-btn",{staticClass:"btn-create-chat",attrs:{color:"primary",label:"Send Message",loading:e.isLoading},on:{click:e.send}})],1)],1)],1)])},s=[],n=(a("12c5"),{name:"Conversation",data(){return{isLoading:!1,messages:[],text:"",token:localStorage.getItem("token"),user:JSON.parse(localStorage.getItem("user")),connection:"",chat_id:"",chat_name:""}},beforeCreate(){console.log("beforeCreate")},created(){console.log("created"),console.log(this.$moment().format("MMMM Do YYYY, h:mm:ss a"))},beforeMount(){console.log("beforeMount")},mounted(){console.log("mounted"),this.chat_id=this.$route.params["id"],this.chat_name=this.$route.query["name"],this.getAllMessages();let e=new WebSocket("ws://localhost:3000/v1/ws?room_id="+this.chat_id+"&jwt="+this.token);e.onmessage=e=>{console.log(e.data);let t=JSON.parse(e.data);this.messages.push(t.Body)},e.onopen=t=>{console.log("Successfully connected to the echo websocket server..."),this.connection=e}},beforeUpdate(){console.log("beforeUpdate")},updated(){console.log("updated")},beforeDestroy(){console.log("beforeDestroy")},destroyed(){console.log("destroyed")},methods:{getAllMessages(){this.$axios.post("/v1/api/chat/room-messages",{roomId:+this.chat_id},{headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{this.messages=e.data.chats})).catch((e=>{console.log(e)}))},send(){if(this.connection.readyState==WebSocket.OPEN&&""!=this.text){const e={chatRoomId:+this.chat_id,chatMessage:this.text};this.connection.send(JSON.stringify(e)),console.log(`Sent: ${JSON.stringify(e)}`),this.text=""}else console.error("WebSocket connection is not open.")}}}),c=n,r=(a("a4ea"),a("2877")),i=a("f09f"),l=a("a370"),h=a("8169"),d=a("27f9"),u=a("9c40"),m=a("eebe"),g=a.n(m),f=Object(r["a"])(c,o,s,!1,null,null,null);t["default"]=f.exports;g()(f,"components",{QCard:i["a"],QCardSection:l["a"],QChatMessage:h["a"],QInput:d["a"],QBtn:u["a"]})},ed49:function(e,t,a){}}]);